syntax = "proto3";

package net.gurigoro.kaiji;
option java_outer_classname = "KaijiOuterClass";

service Kaiji{
  // Ping
  rpc Ping (PingRequest) returns (PingReply);
  // Logging
  rpc Log (LogRequest) returns (Empty);
  // Client Login/Logout
  rpc ClientLogin (ClientLoginRequest) returns (ClientLoginReply);
  rpc ClientLogout (ClientLoginRequest) returns (ClientLogoutReply);
  rpc ClientChangeStatus (ClientChangeStatusRequest) returns (ClientChangeStatusReply);
  // Users
  rpc GetUserById (GetUserByIdRequest) returns (GetUserReply);
  rpc AddUser (AddUserRequest) returns (AddUserReply);
  rpc ModifyUser (ModifyUserRequest) returns (AddUserReply);
}

enum LoginStatus {
  LOGIN_NONE = 0;
  LOGIN_OFFLINE = 1;
  LOGIN_ONLINE = 2;
  LOGIN_GAMING = 3;
  LOGIN_ERROR = 4;
}

enum LogLevel{
  LOG_TRACE = 0;
  LOG_DEBUG = 1;
  LOG_INFO = 2;
  LOG_WARN = 3;
  LOG_ERROR = 4;
  LOG_FATAL = 5;
}

message ClientLoginRequest{
  string accessKey = 1;
  LoginStatus loginStatus = 2;
}

message ClientLoginReply{
  bool isSucceed = 1;
  string accessToken = 2;
}

message ClientChangeStatusRequest{
  string accessToken = 1;
  LoginStatus loginStatus = 2;
}

message ClientChangeStatusReply{
  bool isSucceed = 1;
}

message ClientLogoutRequest{
  string accessToken = 1;
}

message ClientLogoutReply{
  bool isSucceed  = 1;
}

message PingRequest{
  string message = 1;
  int64 time = 2;
}

message PingReply{
  string message = 1;
  int64 time = 2;
}

message LogRequest{
  string accessKey = 1;
  int64 unixTime = 2;
  LogLevel LogLevel = 3;
  int64 userId = 4;
  string text = 5;
}

message Empty{
  // Empty
}

message GetUserByIdRequest{
  string accessToken = 1;
  int64 userId = 2;
}

message GetUserReply{
  bool isFound = 1;
  int64 userId = 2;
  string name = 3;
  int64 point = 4;
  bool isAvailable = 5;
  bool isAnonymous = 6;
  int64 continueCount = 7;
}

message AddUserRequest{
  string accessToken = 1;
  int64 userId = 2;
  string name = 3;
  bool isAvailable = 4;
  bool isAnonymous = 5;
}

message AddUserReply{
  bool isSucceed = 1;
  int64 userId = 2;
}

message ModifyUserRequest{
  string accessToken = 1;
  int64 userId = 2;
  string name = 3;
  bool isAvailable = 4;
  bool isAnonymous = 5;
}

message ModifyUserReply{
  bool isSucceed = 1;
  int64 userId = 2;
}
